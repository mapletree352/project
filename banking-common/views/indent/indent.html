<div class="row page-header">
	<h3><span class="glyphicon glyphicon-chevron-left clickable" ng-click="back()"/> {{dto.crossHubFlag === "Y" ? 'Cross Hub' : null}} </span>Indent <small>{{dto.indentNo}}</small></h3>
</div>
<div class="row page-body">
	<div class="panel-action">
		<div class="panel panel-default">
			<div class="panel-heading" ng-if="dto.templateFlag == 'N'"><strong>{{dto.status | uppercase}}</strong></div>
			<div class="panel-heading" ng-if="dto.templateFlag == 'Y'"><strong>{{dto.templateName | uppercase}}</strong></div>
			<div class="panel-body">
				<strong><big>{{dto.templateType == 'Y' ? dto.templateType : dto.indentNo}}</big></strong><br>
				<div ng-if="dto.templateFlag === 'Y' || dto.status === 'Draft'">
					<small>Created On {{dto.submitDate}}</small><br>
					<small>By {{dto.submittedBy}}</small><br>
					<hr>
				</div>
				<div ng-if="dto.templateFlag === 'N' && dto.status === 'Submitted'">
						<small>Submitted On {{dto.submitDate}}</small><br>
						<small>By {{dto.submittedBy}}</small><br>
					<hr>
				</div>
				<div ng-if="dto.templateFlag === 'N' && dto.status === 'Recommended' && dto.crossHubFlag === 'N' && dto.transferredFlag === 'N'">
					<div ng-if="dto.activityType !== 'Urgent Admin'">
						<small>Recommended On {{dto.updatedDate}}</small><br>
						<small>By {{dto.updatedBy}}</small><br>
						<hr>
					</div>
					<div ng-if="dto.activityType === 'Urgent Admin'">
						<small>Submitted On {{dto.submitDate}}</small><br>
						<small>By {{dto.submittedBy}}</small><br>
						<hr>
					</div>
				</div>
				<div ng-if="dto.templateFlag === 'N' && dto.status === 'Recommended' && dto.crossHubFlag === 'Y'">
					<small>Recommended On {{dto.recommendDate}}</small><br>
					<small>By {{dto.recommendedBy}}</small><br>
					<br>
					<small>Forwarded from {{dto.hubCode}}</small><br>
					<small>On {{dto.updatedDate}}</small><br>
					<br>
					<strong><medium>Supported By:</medium></strong><br>
					<medium>{{dto.hubCode}} (Main)</medium><br>
					<div ng-bind-html="supported.hubNamelist"></div>
					<br>
					<strong><medium>Reasons:</medium></strong><br>
					<small>{{dto.reasons}}</small><br>
					<hr>
				</div>
				<div ng-if="dto.templateFlag === 'N' && dto.status === 'Recommended' && dto.transferredFlag === 'Y'">
					<small>Recommended On {{dto.recommendDate}}</small><br>
					<small>By {{dto.recommendedBy}}</small><br>
					<br>
					<small>Forwarded from {{dto.oldHubCode}}</small><br>
					<small>On {{dto.updatedDate}}</small><br>
					<br>
					<strong><medium>Supported By:</medium></strong><br>
					<medium>{{dto.hubCode}}</medium><br>
					<br>
					<strong><medium>Reasons:</medium></strong><br>
					<small>{{dto.reasons}}</small><br>
					<hr>
				</div>
				<div ng-if="dto.templateFlag === 'N' && (dto.status === 'Approved' || dto.status === 'Confirmed')">
					<small>{{dto.status == 'Approved' ? 'Approved' : 'Confirmed'}} On {{dto.status == 'Approved' ? dto.approvedDate : dto.confirmedDate}}</small><br>
					<small>By {{dto.status === 'Approved' ? dto.approvedBy : dto.confirmedBy}}</small><br>
					<br>
					<div ng-if="dto.crossHubFlag === 'Y'">
						<strong><medium>Supported By:</medium></strong><br>
						<medium>{{dto.hubCode}} (Main)</medium><br>
						<div ng-bind-html="supported.hubNamelist"></div>
						<br>
						<strong><medium>Reasons:</medium></strong><br>
						<small>{{dto.reasons}}</small><br>
						<hr>
					</div>
					<div ng-if="dto.transferredFlag === 'Y'">
						<small>Forwarded from </small><br>
						<medium>{{dto.oldHubCode}}</medium><br>
						<br>
						<strong><medium>Reasons:</medium></strong><br>
						<small>{{dto.reasons}}</small><br>
					</div>
					<hr>
				</div>
				<div ng-if="dto.templateFlag === 'N' && (dto.status === 'Cancelled' || dto.status === 'Reverted' || dto.status === 'Recalled' || dto.status === 'Rejected' || dto.status === 'Completed' || dto.status === 'Expired' || dto.status === 'Lapsed')">
					<div ><small>{{dto.status}} On {{dto.updatedDate}}</small><br></div>
					<small>By {{dto.updatedBy}}</small><br>
					<br>
					<div ng-if="dto.crossHubFlag === 'Y'">
						<strong><medium>Supported By:</medium></strong><br>
						<medium>{{dto.hubCode}} (Main)</medium><br>
						<div ng-bind-html="supported.hubNamelist"></div>
					</div>
					<div ng-if="dto.transferredFlag === 'Y'">
						<strong><medium>Forwarded Whole Indent To:</medium></strong><br>
						<medium>{{dto.hubCode}}</medium><br>
					</div>
					<br>
					<strong><medium>Reasons:</medium></strong><br>
					<medium>{{dto.reasons}}</medium><br>
					<hr ng-if="dto.status !== 'Cancelled' && dto.status !== 'Rejected'">
				</div>
				<button type="button" class="btn btn-primary btn-block" data-toggle="modal" data-target="#recommendIndentModal" ng-if="dto.templateFlag == 'N' && dto.status == 'Submitted' && session.rights['showIndentRecommendation']">Recommend Indent</button>			
				<button type="button" class="btn btn-primary btn-block" data-toggle="modal" data-target="#approveIndentModal" ng-if="dto.templateFlag == 'N' && dto.status=='Recommended' && dto.transferredFlag =='N' && session.rights['showIndentApproval'] && (session.userRole.hub === dto.hubCode || session.userRole.role==='Super User')">Approve Indent</button>
				<button type="button" class="btn btn-primary btn-block" data-toggle="modal" data-target="#approveCvModal" ng-if="dto.templateFlag == 'N' && dto.status=='Recommended' && dto.cvStatus == 'Pending' && session.rights['showCentralVoteApproval']">Approve Central Vote</button>
				<button type="button" class="btn btn-primary btn-block" data-toggle="modal" data-target="#acceptMultiIndentModal" ng-if="dto.templateFlag == 'N' && (dto.status=='Recommended' || dto.status=='Approved' || dto.status=='Confirmed') && dto.crossHubFlag == 'Y' && session.rights['showIndentAcceptance'] && session.userRole.hub !== dto.hubCode && supporting === 'Pending'">Accept Indent</button>			 
				<button type="button" class="btn btn-primary btn-block" data-toggle="modal" data-target="#acceptSingleIndentModal" ng-if="dto.templateFlag == 'N' && dto.status=='Recommended' && dto.transferredFlag =='Y' && session.rights['showIndentAcceptance'] && session.userRole.hub === dto.hubCode">Accept Indent</button>
				<button type="button" class="btn btn-primary btn-block" data-toggle="modal" data-target="#confirmIndentModal" ng-if="dto.templateFlag == 'N' && (dto.crossHubFlag == 'N' || (dto.crossHubFlag == 'Y' && session.userRole.hub === dto.hubCode)) && (dto.transferredFlag =='N' || (dto.transferredFlag =='Y' && session.userRole.hub === dto.hubCode)) && dto.status=='Approved' && session.rights['showIndentConfirmation'] && dto.activityType !='MT Maintenance'">Confirm Indent</button>
				<button type="button" class="btn btn-primary btn-block" data-toggle="modal" data-target="#confirmIndentModal" ng-if="dto.templateFlag == 'N' && (dto.crossHubFlag == 'N' || (dto.crossHubFlag == 'Y' && session.userRole.hub === dto.hubCode)) && (dto.transferredFlag =='N' || (dto.transferredFlag =='Y' && session.userRole.hub === dto.hubCode)) && dto.status=='Approved' && session.rights['showIndentMtMaintConfirmation'] && dto.activityType =='MT Maintenance'">Confirm Indent</button>
				
				<button type="button" class="btn btn-default btn-block" data-toggle="modal" data-target="#revertIndentModal" ng-if="dto.templateFlag == 'N' && dto.status !='Lapsed' && dto.status !='Submitted' && dto.status !='Partially Completed' && dto.status !='Completed' && dto.status !='Rejected' && dto.status != 'Draft' && dto.status !='Confirmed' && dto.status !='Cancelled' && dto.status !='Expired' && dto.status !='Recalled' && dto.status !='Reverted' && dto.status !='Unfulfilled' && dto.activityType != 'MT Admin' && dto.activityType !='MT Maintenance' && session.userRole.cat !== 'Node' && session.rights['showRvtBtn'] && (dto.crossHubFlag == 'N' || (dto.crossHubFlag == 'Y' && session.userRole.hub === dto.hubCode)) && (dto.transferredFlag == 'N' || (dto.transferredFlag == 'Y' && session.userRole.hub === dto.hubCode))">Revert Indent</button>
<!-- 				<button type="button" class="btn btn-default btn-block" data-toggle="modal" data-target="#revertIndentModal" ng-if="dto.templateFlag == 'N' && dto.status !='Lapsed' && dto.status !='Submitted' && dto.status !='Partially Completed' && dto.status !='Completed' && dto.status !='Rejected' && dto.status != 'Draft' && dto.status !='Cancelled' && dto.status !='Expired' && dto.status !='Recalled' && dto.status !='Reverted' && dto.status !='Unfulfilled' && dto.activityType == 'MT Admin' && session.userRole.cat === 'Node' && session.rights['showRvtBtn'] && (dto.crossHubFlag == 'N' || (dto.crossHubFlag == 'Y' && session.userRole.hub === dto.hubCode)) && (dto.transferredFlag == 'N' || (dto.transferredFlag == 'Y' && session.userRole.hub === dto.hubCode))">Revert Indent</button> -->
				<!-- <button type="button" class="btn btn-default btn-block" data-toggle="modal" data-target="#revertIndentModal" ng-if="dto.templateFlag == 'N' && dto.status !='Lapsed' && dto.status !='Submitted' && dto.status !='Partially Completed' && dto.status !='Completed' && dto.status !='Rejected' && dto.status != 'Draft' && dto.status !='Confirmed' && dto.status !='Cancelled' && dto.status !='Expired' && dto.status !='Recalled' && dto.status !='Reverted' && dto.status !='Unfulfilled' && dto.activityType != 'MT Admin' && dto.activityType !='MT Maintenance' && session.rights['showRvtBtn'] && dto.crossHubFlag == 'N'">Revert Indent</button> -->	
				<button type="button" class="btn btn-default btn-block" data-toggle="modal" data-target="#recallIndentModal" ng-if="dto.templateFlag == 'N' && dto.status !='Lapsed' && dto.status !='Partially Completed' && dto.status !='Completed' && dto.status !='Rejected' && dto.status != 'Draft' && dto.status !='Confirmed' && dto.status !='Cancelled' && dto.status !='Expired' && dto.status !='Recalled' && dto.status !='Reverted' && dto.status !='Approved' && dto.status !='Unfulfilled' && dto.activityType != 'MT Admin' && session.rights['showRclBtn']  && (session.userRole.hub === dto.hubCode || session.userRole.unitCode === dto.unitCode || session.userRole.role === 'Super User')">Recall Indent</button>		
				<button type="button" class="btn btn-default btn-block" data-toggle="modal" data-target="#recallIndentModal" ng-if="dto.templateFlag == 'N' && dto.status =='Confirmed' && dto.activityType == 'MT Admin' && session.rights['showRclBtn']">Recall Indent</button>
				<button type="button" class="btn btn-default btn-block" data-toggle="modal" data-target="#forwardAssistModal" ng-if="dto.templateFlag == 'N' && (dto.status=='Recommended' || dto.status=='Approved' || dto.status=='Confirmed') && dto.crossHubFlag != 'Y'  && dto.activityType != 'MT Admin' && dto.activityType !='MT Maintenance' && dto.transferredFlag != 'Y' && session.userRole.hub === dto.hubCode && session.rights['showForBtn']">Forward Indent (Multi)</button>
				<button type="button" class="btn btn-default btn-block" data-toggle="modal" data-target="#forwardWholeModal" ng-if="dto.templateFlag == 'N' && dto.status=='Recommended' && dto.crossHubFlag != 'Y' && dto.transferredFlag != 'Y' && dto.activityType != 'MT Admin' && dto.activityType !='MT Maintenance' && session.userRole.hub === dto.hubCode && session.rights['showForBtn']">Forward Indent (Whole)</button>
				<button type="button" class="btn btn-default btn-block" data-toggle="modal" data-target="#amendIndentModal" ng-if="dto.templateFlag == 'N' && (dto.status == 'Reverted' || dto.status == 'Recalled') && session.rights['showAmendBtn']" ng-click="amend()">Amend Indent</button>
				<button type="button" class="btn btn-default btn-block" data-toggle="modal" data-target="#amendIndentModal" ng-if="dto.status == 'Draft' && session.rights['showAmendBtn']" ng-click="amend()">Amend Indent</button>
				<button type="button" class="btn btn-default btn-block" data-toggle="modal" data-target="#amendIndentModal" ng-if="dto.templateFlag == 'Y' && dto.templateType =='Role-Based'" ng-click="amend()">Edit Template</button>
				<button type="button" class="btn btn-default btn-block" data-toggle="modal" data-target="#amendIndentModal" ng-if="dto.templateFlag == 'Y' && dto.templateType =='Global' && session.rights['showGlobalTemplateOpt']" ng-click="amend()">Edit Template</button>
				
				<button type="button" class="btn btn-danger btn-block" data-toggle="modal" data-target="#rejectAppIndentModal" ng-if="dto.templateFlag == 'N' && dto.status == 'Recommended' && dto.transferredFlag == 'N' && session.userRole.hub === dto.hubCode && session.rights['showIndentApproval']">Reject Indent</button>
				<button type="button" class="btn btn-danger btn-block" data-toggle="modal" data-target="#rejectAccSingleIndentModal" ng-if="dto.templateFlag == 'N' && dto.status=='Recommended' && dto.transferredFlag == 'Y' && session.userRole.hub === dto.hubCode && session.rights['showIndentAcceptance']">Reject Indent</button>
				<button type="button" class="btn btn-danger btn-block" data-toggle="modal" data-target="#rejectAccMultiIndentModal" ng-if="dto.templateFlag == 'N' && (dto.status=='Recommended' || dto.status=='Approved' || dto.status=='Confirmed') && dto.crossHubFlag == 'Y' && session.rights['showIndentAcceptance'] && session.userRole.hub !== dto.hubCode && supporting === 'Pending'">Reject Indent</button>
				<button type="button" class="btn btn-danger btn-block" data-toggle="modal" data-target="#rejectRecIndentModal" ng-if="dto.templateFlag == 'N' && dto.status == 'Submitted' && session.rights['showIndentRecommendation']">Reject Indent</button>
				<button type="button" class="btn btn-danger btn-block" data-toggle="modal" data-target="#rejectCfmIndentModal" ng-if="dto.templateFlag == 'N' && (dto.crossHubFlag == 'N' || (dto.crossHubFlag == 'Y' && session.userRole.hub === dto.hubCode)) && (dto.transferredFlag =='N' || (dto.transferredFlag =='Y' && session.userRole.hub === dto.hubCode)) && dto.status == 'Approved' && session.rights['showIndentConfirmation']  && dto.activityType !='MT Maintenance'">Reject Indent</button>
				<button type="button" class="btn btn-danger btn-block" data-toggle="modal" data-target="#rejectCfmIndentModal" ng-if="dto.templateFlag == 'N' && (dto.crossHubFlag == 'N' || (dto.crossHubFlag == 'Y' && session.userRole.hub === dto.hubCode)) && (dto.transferredFlag =='N' || (dto.transferredFlag =='Y' && session.userRole.hub === dto.hubCode)) && dto.status == 'Approved' && session.rights['showIndentMtMaintConfirmation']  && dto.activityType =='MT Maintenance'">Reject Indent</button>
				<button type="button" class="btn btn-danger btn-block" data-toggle="modal" data-target="#rejectCvModal" ng-if="dto.templateFlag == 'N' && dto.cvStatus == 'Pending' && session.rights['showCentralVoteApproval']">Reject Central Vote</button>
				<button type="button" class="btn btn-danger btn-block" data-toggle="modal" data-target="#cancelIndentModal" ng-if="dto.templateFlag == 'N' && (dto.status !='Completed' && dto.status !='Lapsed' && dto.status !='Rejected' && dto.status !='Cancelled' && dto.status !='Expired' && dto.status !='Draft' && dto.status !='Partially Completed') && session.rights['showCnlBtn'] && dto.activityType !='MT Maintenance'  && dto.activityType !='MT Admin' && session.userRole.cat !== 'Node' && session.userRole.cat !== 'Hub'">Cancel Indent</button>
				<button type="button" class="btn btn-danger btn-block" data-toggle="modal" data-target="#cancelIndentModal" ng-if="dto.templateFlag == 'N' && (dto.status !='Completed' && dto.status !='Lapsed' && dto.status !='Rejected' && dto.status !='Cancelled' && dto.status !='Expired' && dto.status !='Draft' && dto.status !='Partially Completed') && session.rights['showCnlBtn'] && dto.activityType ==='MT Admin' && session.userRole.cat === 'Node'">Cancel Indent</button>
				<button type="button" class="btn btn-danger btn-block" data-toggle="modal" data-target="#deleteDraftModal"ng-if="dto.templateFlag == 'N' && dto.status == 'Draft'">Delete Draft</button>		
			</div>
		</div>
		<!-- <div class="alert alert-info">
			<div class="panel-heading"><strong>REASONS</strong>
				<div>
					<p><span class="glyphicon glyphicon-exclamation-sign"></span>{{dto.reasons}}</p>
				</div>
			</div>
		</div> -->
	</div>
	<div class="panel-main">
		<ul class="nav nav-tabs">
			<li class="active"><a href="" data-target="#overview" data-toggle="tab" ng-click="tab='overview'">Overview</a></li>
			<li><a href="" data-target="#tasks" data-toggle="tab" ng-click="tab='tasks'">Tasks</a></li>
			<li><a href="" data-target="#auditLog" data-toggle="tab" ng-click="tab='audit'">Audit Log</a></li>
		</ul>
		<div class="tab-content">
			<div class="tab-pane fade in active" id="overview">
				<form class="form-horizontal">
					<fieldset>
						<div class="form-group">
							<label class="col-sm-2 control-label">Activity {{ dto.activityType.startsWith('MT') ? 'Purpose' : 'Name' }}</label>
							<div class="col-sm-4 control-value">{{dto.name}}</div>
							<label class="col-sm-2 control-label">Activity Type</label>
							<div class="col-sm-4 control-value">{{dto.activityType}} - {{dto.activity}}</div>
						</div>
						<div class="form-group" ng-if="!dto.activityType.startsWith('MT')">
							<label class="col-sm-2 control-label">Customer Unit</label>
							<div class="col-sm-4 control-value">{{dto.unit}}</div>
							<label class="col-sm-2 control-label">Sub-Unit</label>
							<div class="col-sm-4 control-value">{{dto.subunit != null ? dto.subunit : '-'}}</div>
						</div>
						<hr>
						<div class="form-group">
							<label class="col-sm-2 control-label">Reporting Date/Time</label>
							<div class="col-sm-4 control-value">{{dto.startDate != null ? dto.startDate  : '-'}}</div>
							<label class="col-sm-2 control-label">Completion Date/Time</label>
							<div class="col-sm-4 control-value">{{dto.endDate != null ? dto.endDate : '-'}}</div>
						</div>
						<div class="form-group">
							<label class="col-sm-2 control-label">Duration</label>
							<div class="col-sm-4 control-value">{{dto.duration | number: 1}} {{ dto.overseasFlag == 'N' ? 'Hours' : 'Days' }}</div>
							<label class="col-sm-2 control-label">{{dto.overseasFlag == 'N' ? 'Camp Movement' : 'Country' }}</label>
							<div class="col-sm-4 control-value">{{dto.overseasFlag == 'N' ? dto.campMovement : dto.country }}</div>
						</div>
						<div ng-if="!dto.activityType.startsWith('MT')">
							<div class="form-group">
								<label class="col-sm-2 control-label">Reporting Venue Type</label>
								<div class="col-sm-4 control-value">{{dto.reportingVenueType != null ? dto.reportingVenueType : '-'}}</div>
								<label class="col-sm-2 control-label">Destination Venue Type</label>
								<div class="col-sm-4 control-value">{{dto.destinationVenueType != null ? dto.destinationVenueType : '-'}}</div>
							</div>
							<div class="form-group">
								<label class="col-sm-2 control-label">Reporting Venue</label>
								<div class="col-sm-4 control-value">{{dto.reportingVenue != null ? dto.reportingVenue : '-'}}</div>
								<label class="col-sm-2 control-label">Destination Venue</label>
								<div class="col-sm-4 control-value">{{dto.destinationVenue != null ? dto.destinationVenue : '-'}}</div>
							</div>
							<div class="form-group">
								<label class="col-sm-2 control-label">Reporting Info</label>
								<div class="col-sm-10 control-value">{{dto.reportingInfo != null ? dto.reportingInfo : '-'}}</div>
							</div>
							<div class="form-group">
								<label class="col-sm-2 control-label">Additional Info</label>
								<div class="col-sm-10 control-value">{{dto.additionalInfo != null ? dto.additionalInfo : '-'}}</div>
							</div>
							<hr>
							<div class="form-group">
								<label class="col-sm-2 control-label">Reporting POC</label>
								<div class="col-sm-10 control-value">{{dto.pocName}} ({{dto.pocNricNo}}) {{dto.Resource.operatorQuantity}}</div>
							</div>
							<div class="form-group">
								<label class="col-sm-2 control-label">Office Phone</label>
								<div class="col-sm-4 control-value">{{dto.pocOfficeNo != null ? dto.pocOfficeNo : '-'}}</div>
								<label class="col-sm-2 control-label">Mobile Phone</label>
								<div class="col-sm-4 control-value">{{dto.pocMobileNo != null ? dto.pocMobileNo : '-'}}</div>
							</div>
						</div>
						<div ng-if="dto.activityType.startsWith('MT')">
							<div class="form-group">
								<label class="col-sm-2 control-label">Destination Venue</label>
								<div class="col-sm-4 control-value">{{dto.destinationVenue}}</div>
							</div>
							<div class="form-group">
								<label class="col-sm-2 control-label">Additional Info</label>
								<div class="col-sm-10 control-value">{{dto.additionalInfo != null ? dto.additionalInfo : '-'}}</div>
							</div>
						</div>
						<hr>
						<div ng-if="!dto.activityType.startsWith('MT')">
							<div class="form-group">
								<label class="col-sm-2 control-label">Waiting List</label>
								<div class="col-sm-4 control-value">
									<div ng-if="dto.waitinglistFlag === 'Y'">
										<div ng-if="dto.approvedFlag != null && dto.approvedFlag === 'Y'">No</div>
										<div ng-if="dto.approvedFlag == null  || (dto.approvedFlag != null && dto.approvedFlag === 'N')">Yes</div>
									</div>
									<div ng-if="dto.waitinglistFlag === 'N'">No</div>	
								</div>														
								<label class="col-sm-2 control-label">Cross Hub Support</label>
								<div class="col-sm-4 control-value">{{dto.crossHubFlag === 'Y' ? 'Yes' : 'No'}}</div>
							</div>
							<div class="form-group">
								<label class="col-sm-2 control-label">Recalled Before</label>
								<div class="col-sm-4 control-value">{{dto.recalledFlag === 'Y' ? 'Yes' : 'No'}}</div>
								<label class="col-sm-2 control-label">Reverted Before</label>
								<div class="col-sm-4 control-value">{{dto.revertedFlag === 'Y' ? 'Yes' : 'No'}}</div>
							</div>
						</div>
					</fieldset>
					<fieldset>
						<legend>Resources
							<!-- <button type="button" class="btn btn-default navbar-btn btn-xs"><div class="glyphicon glyphicon-minus" /> Cancel Selected Resources</button> -->
						</legend>
						<table st-table="indentRecources" st-safe-src="dto.indentResources" class="table table-bordered table-responsive table-condensed">
							<thead>
								<tr>
									<th rowspan="2" class="text-center">#</th>
									<th rowspan="2">Vehicle Type</th>
									<th rowspan="2">Resource Type</th>
									<th rowspan="2" class="text-center">Quantity</th>
									<th rowspan="2" class="text-center">Park-Down</th>
									<th rowspan="2" class="text-center">Credits</th>
								</tr>
							</thead>
							<tr ng-repeat="record in dto.indentResources">
								<td class="text-center"><button type="button" class="btn btn-default btn-xs" ng-click="showIndentResourceModal(record.id)">View</button></td>
								<td>{{record.vehicleTypeName}}</td>
								<td>{{record.resourceTypeName}}</td>
								<td class="text-center">{{record.operatorQuantity || record.vehicleQuantity}}</td>
								<td class="text-center"">{{record.parkdownFlag  ==='Y' ? 'Yes (' + (record.parkdownCredits | number: 1) + ' Credits)' : 'No'}}</td>
								<td class="text-center">{{record.credits | number: 1}}</td>
							<tfoot>
								<tr>
									<td class="text-right" colspan="5"><strong>Total Credits: </strong></td>
									<td class="text-center">{{dto.credits | number: 1}}</td>
								</tr>
							</tfoot>
						</table>
					</fieldset>
				</form>
			</div>
			<div class="tab-pane fade" id="tasks">
			<form class="form-horizontal">
				<div>
					<button type="button" class="btn btn-default navbar-btn btn-xs" ng-if="session.rights['showBestMatchTaskBtn'] && dto.crossHubFlag === 'N'" ng-click="bestMatchAssign()"><div class="glyphicon glyphicon-log-in" /> Assign Best Matched Resources for Selected Tasks</button>
					<button class="btn btn-default navbar-btn btn-xs" data-dismiss="modal" ng-if="session.rights['showBestMatchTaskBtn']"  type="file" ngf-select="uploadFile($file, $invalidFiles)" accept=".xls,.xlsx" ngf-max-height="1000" ngf-max-size="1MB"><div class="glyphicon glyphicon-log-in" /> Assign Resources for NS TO</button>
					<button type="button" class="btn btn-default navbar-btn btn-xs" ng-if="session.rights['showUnassignTaskBtn']" ng-click="unassignResource()"><div class="glyphicon glyphicon-log-out"/> Unassign Resources for Selected Tasks</button>
					<button type="button" class="btn btn-default navbar-btn btn-xs" ng-if="session.rights['showRefundTaskBtn']" data-toggle="modal" ng-click="creditRefund()"><div class="glyphicon glyphicon-remove" /> Refund Selected TO Resources</button>
<!-- 					<button class="btn btn-default navbar-btn btn-xs" ng-if="session.rights['showBestMatchTaskBtn']" type="file" ngf-select="uploadFile($file, $invalidFiles)" accept=".xls,.xlsx" ngf-max-height="1000" ngf-max-size="1MB"><div class="glyphicon glyphicon-log-in" /> Mass Assign NSTO Indent</button> -->
				</div>
				<table st-table="tasks" st-safe-src="dto.tasks" class="table table-striped table-bordered table-responsive table-condensed small">
					<tr>
						<th class="text-center"><input type="checkbox" ng-model="checkboxes.allTask" ng-click="checkAllTask()"></th>
						<th no-sort>#</th>
						<th st-sort="id">Task ID</th>
						<th st-sort="status">Task Status</th>
						<th no-sort>Driver NRIC</th>
						<th no-sort>Driver Name</th>
						<th no-sort>Driver Node</th>
						<th no-sort>Vehicle Type</th>
						<th no-sort>Vehicle No.</th>
						<th no-sort>Vehicle Node</th>
						<th no-sort>Type</th>
						<th st-sort="startDate">Start Date/Time</th>
						<th st-sort="endDate">End Date/Time</th>
						<th></th>
					</tr>
					<tr ng-repeat="record in tasks">
						<td class="text-center"><input type="checkbox" ng-model="checkboxes.taskRecords[record.id]" ng-click="checkboxes.allTask = false"></td>
						<td>{{$index + searchDTO.startIndex + 1}}</td>
						<td><a href="#/task/{{record.id}}">{{record.id}}</a></td>
						<td>{{record.status}}</td>
						<td><div ng-if="!record.driverId || record.driverId=='-1' || session.userRole.cat === 'Unit'">{{record.driverNric}}</div><div ng-if="record.driverId && record.driverId!='-1' && session.userRole.cat !== 'Unit'"><a href="#/driver/{{record.driverNric}}">{{record.driverNric}}</a></div></td>
						<td>{{record.driverName}}</td>
						<td>{{record.driverNode}}</td>
						<td>{{record.vehicleType}}</td>
						<td><div ng-if="!record.vehicleId || record.vehicleId=='-1' || session.userRole.cat === 'Unit'">{{record.vehicleNo}}</div><div ng-if="record.vehicleId && record.vehicleId!='-1' && session.userRole.cat !== 'Unit'"><a href="#/vehicle/{{record.vehicleNo}}">{{record.vehicleNo}}</a></div></td>
						<td>{{record.vehicleNode}}</td>
						<td>{{record.parkdownIndentFlag === 'Y' ? 'ParkDown' : 'Normal'}}</td>
						<td>{{record.startDate}}</td>
						<td>{{record.endDate}}</td>
						<td>
							<div class="btn-group" ng-if="record.isAssign=='true' && (record.status=='Pending Confirmation' || record.status=='Pending Execution' || record.status=='Under Execution') && session.userRole.cat !== 'Unit'">
								<button type="button" class="btn btn-default btn-block btn-xs dropdown-toggle" data-toggle="dropdown">{{((record.driverId && record.driverId!='-1') || record.driverName=='MULTIPLE DRIVER') && ((record.vehicleId && record.vehicleId!='-1') || record.vehicleNo == 'MULTIPLE VEHICLE') ? 'Reassign' : 'Assign'}}<span class="caret"></span></button>
								<ul class="dropdown-menu">
									<li><a class="clickable btn-xs" data-toggle="modal" data-target="#allocateDriverModal" ng-if="session.rights['showAssignDriverBtn'] && record.driverId!='-1' && (record.status=='Pending Confirmation' || record.status=='Pending Execution')" ng-click="selectedRecord(record,'driver')">Driver</a></li>
									<li><a class="clickable btn-xs" ng-if="session.rights['showAssignVehicleBtn'] && record.vehicleId!='-1'&& (record.status=='Pending Confirmation' || record.status=='Pending Execution')" ng-click="selectedRecord(record, 'vehicle')">Vehicle</a></li>
								</ul>
							</div>
							<div class="btn-group" ng-if="record.isAssign=='false'">
								<button type="button" ng-click = "go('/task/'+record.id)" class="btn btn-default btn-block btn-xs dropdown-toggle" data-toggle="dropdown">{{((record.driverId && record.driverId!='-1') || record.driverName=='MULTIPLE DRIVER') && ((record.vehicleId && record.vehicleId!='-1') || record.vehicleNo == 'MULTIPLE VEHICLE') ? 'Reassign' : 'Assign'}}</button>
							</div>
							
						</td>
					</tr>
				</table>
				</form>
			</div>
			<div ng-if="tab=='audit'" class="tab-pane fade" id="auditLog">
				<table st-table="records" st-pipe="getAuditLog" class="table table-striped table-bordered table-responsive table-condensed small">
					<tr>
						<th no-sort>#</th>
						<th no-sort>Action Date</th>
						<th no-sort>Action By</th>
						<th no-sort>Action</th>
						<th no-sort>New Value</th>
						<th no-sort>Old Value</th>
					</tr>
					<tr ng-repeat="record in records">
						<td>{{$index + searchDTO.startIndex + 1}}</td>
						<td>{{record.createdDate}}</td>
						<td>{{record.createdBy}}</td>
						<td>{{record.action === "I" ? "INSERT" : "UPDATE"}}</td>
						<td>{{record.newValue}}</td>
						<td>{{record.oldValue}}</td>
					</tr>
					<tfoot>
						<tr>
							<td colspan="6">
								<div st-template="pagination.html" st-pagination="" st-items-by-page="searchDTO.pageSize"></div>
							</td>
						</tr>
					</tfoot>
				</table>
			</div>
		</div>
	</div>
</div>

<div class="modal fade" id="indentResourceModal">
	<div class="modal-dialog" style="width:800px">
		<div class="modal-content">
		
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal"><span>&times;</span></button>
				<h4 class="modal-title">Resource {{indentResource.id}}</h4>
			</div>
			
			<div class="modal-body">
				<div class="container-fluid">
					<form class="form-horizontal">
						<div class="form-group">
							<label class="col-sm-3 control-label">Request Period</label>	
							<div class="col-sm-6 control-value">{{dto.dateRange}}</div>
						</div>

						<div class="form-group">
							<label class="col-sm-3 control-label">Resource Type</label>
							<div class="col-sm-9 control-value">{{indentResource.resourceTypeName}}</div>
						</div>

						<div class="form-group" ng-if="(indentResource.resourceType === 'VEH_DRV' || indentResource.resourceType === 'VEH')">
							<label class="col-sm-3 control-label">Vehicle Purpose</label>
							<div class="col-sm-7 control-value">{{indentResource.purposeName != null ? indentResource.purposeName : dto.activityType}}</div>
						</div>

						<div class="form-group">
							<label class="col-sm-3 control-label">Vehicle Type</label>
							<div class="col-sm-9 control-value">{{indentResource.vehicleTypeName}}</div>
						</div>

						<div class="form-group">
							<label class="col-sm-3 control-label">Required Quantity</label>
							<div class="col-sm-2 control-value" ng-if="indentResource.resourceType === 'DRV'">{{indentResource.operatorQuantity}}</div>
							<div class="col-sm-2 control-value" ng-if="indentResource.resourceType !== 'DRV'">{{indentResource.vehicleQuantity}}</div>					
						</div>
								
						<div class="form-group" ng-if="indentResource.resourceType === 'VEH_DRV'">
							<label class="col-sm-3 control-label">Park-Down Required</label>
							<div class="col-sm-2 control-value">{{indentResource.parkdownFlag == 'Y' ? 'Yes' : 'No'}}</div>
							<div ng-if="indentResource.parkdownFlag === 'Y'">
								<label class="col-sm-3 control-label">Within Supporting Node Complex</label>
							<div class="col-sm-2 control-value">{{indentResource.parkdownCampMovement == 'IN' ? 'Yes' : 'No'}}</div>
						</div>
						</div>
						
						

						<div class="form-group" ng-if="indentResource.parkdownFlag === 'Y'">
							<label class="col-sm-3 control-label">Park-Down Date/Time</label>
							<div class="col-sm-3 control-value">{{indentResource.parkdownTime}}</div>
						<label class="col-sm-2 control-label">within</label>
							<div class="col-sm-1 control-value">{{indentResource.parkdownDuration / 2}} Hours</div>
							<div class="col-sm-2 control-value" style="text-align:left" >({{indentResource.parkdownQuantity}} TOs required)</div>
						</div>
						
						<div class="form-group" ng-if="indentResource.resourceType === 'VEH_DRV' || indentResource.resourceType === 'DRV'">
							<label class="col-sm-3 control-label">Tow Types</label>
							<div class="col-sm-9 control-value">{{indentResource.towTypeNameList == "" ? '-' : indentResource.towTypeNameList}}</div>
						</div>

						<div class="form-group" ng-if="indentResource.resourceType === 'VEH_DRV' || indentResource.resourceType === 'DRV'">
							<label class="col-sm-3 control-label">Soldier Proficiencies</label>
							<div class="col-sm-9 control-value">{{indentResource.proficiencyNameList == "" ? '-' : indentResource.proficiencyNameList}}</div>
						</div>

						<div class="form-group">
							<label class="col-sm-3 control-label">Remarks</label>
							<div class="col-sm-9 control-value">{{indentResource.remarks == null ? '-' : indentResource.remarks}}</div>
						</div>
					</form>
				</div>
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
			</div>																			
		</div>
	</div>
</div>

<div class="modal fade" id="recommendIndentModal" tabindex="-1">
	<div class="modal-dialog" style="width:400px">
		<div class="modal-content">
			<div class="modal-header">
				<button class="close" data-dismiss="modal">&times;</button>
				<h4 class="modal-title">Confirm?</h4>
			</div>
			<div class="modal-body">
				<p>Are you sure you want to approve and/or reject the Indents?</p>
				<p>Please note that a <b>50%</b> credit penalty will be incurred if the indent is cancelled 45 days from the execution date.</p>
				<p>If your indent is on the waiting list and subjected to resource availability, the system will inform you of the outcome 14 days from the execution date.</p>
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-default" data-dismiss="modal">Cancel</button>
				<button type="button" class="btn btn-primary" data-dismiss="modal" ng-click="submit('INDT_REC')">Recommend Indent</button>
			</div>
		</div>
	</div>
</div>

<div class="modal fade" id="approveIndentModal" tabindex="-1">
	<div class="modal-dialog" style="width:400px">
		<div class="modal-content">
			<div class="modal-header">
				<button class="close" data-dismiss="modal">&times;</button>
				<h4 class="modal-title">Confirm?</h4>
			</div>
			<div class="modal-body">
				<div class="container-fluid">
					<p>Are you sure you want to approve Indents?</p> 
					<p>Approved Indents will have Driving Tasks generated for Resource Allocation.</p>
				</div>
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-default" data-dismiss="modal">Cancel</button>
				<button type="button" class="btn btn-primary" data-dismiss="modal" ng-click="submit('INDT_APP')">Approve Indent</button>
			</div>
		</div>
	</div>
</div>

<div class="modal fade" id="approveCvModal" tabindex="-1">
	<div class="modal-dialog" style="width:400px">
		<div class="modal-content">
			<div class="modal-header">
				<button class="close" data-dismiss="modal">&times;</button>
				<h4 class="modal-title">Confirm?</h4>
			</div>
			<div class="modal-body">
				<div class="container-fluid">
					<p>Are you sure you want to approve Indent for Central Vote Credit Use?</p>
				</div>
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-default" data-dismiss="modal">Cancel</button>
				<button type="button" class="btn btn-primary" data-dismiss="modal" ng-click="submit('APP')">Approve Indent</button>
			</div>
		</div>
	</div>
</div>

<div class="modal fade" id="acceptSingleIndentModal" tabindex="-1">
	<div class="modal-dialog" style="width:400px">
		<div class="modal-content">
			<div class="modal-header">
				<button class="close" data-dismiss="modal">&times;</button>
				<h4 class="modal-title">Confirm?</h4>
			</div>
			<div class="modal-body">
				<div class="container-fluid">
					<p>Are you sure you want to accept Indents?</p>
					<p>Approved Indents will have Driving Tasks generated for Resource Allocation.</p>
				</div>
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-default" data-dismiss="modal">Cancel</button>
				<button type="button" class="btn btn-primary" data-dismiss="modal" ng-click="submit('INDT_ACC_SIN')">Accept Indent</button>
			</div>
		</div>
	</div>
</div>

<div class="modal fade" id="acceptMultiIndentModal" tabindex="-1">
	<div class="modal-dialog" style="width:400px">
		<div class="modal-content">
			<div class="modal-header">
				<button class="close" data-dismiss="modal">&times;</button>
				<h4 class="modal-title">Confirm?</h4>
			</div>
			<div class="modal-body">
				<div class="container-fluid">
					<p>Are you sure you want to accept Indents?</p><p> Accepted Indents will only have rights to amend allocation of tasks assigned by main supporting hub.</p>
				</div>
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-default" data-dismiss="modal">Cancel</button>
				<button type="button" class="btn btn-primary" data-dismiss="modal" ng-click="submit('INDT_ACC_MUL')">Accept Indent</button>
			</div>
		</div>
	</div>
</div>

<div class="modal fade" id="recallIndentModal" tabindex="-1">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<button class="close" data-dismiss="modal">&times;</button>
				<h4 class="modal-title">Confirm?</h4>
			</div>
			<div class="modal-body">
				<div class="form-group">
					<label class="col-sm-2 control-label">Reasons for Recalling</label>
					<div class="col-sm-9">
						<textarea class="form-control" rows="3" ng-model="dto.reasons"></textarea>
					</div>
				</div>
				<label class="col-sm-2 control-label"></label>	
				<div class="col-sm-9">
					<p></p>
					<p>Please note that recalled indent will:</p>
					<p>- have 3 days to be re submitted and recommended if not it will <b>expire</b>.</p>
					<p>- incurred <b>50%</b> credit penalty difference if the indent is <b>45</b> days <br> &nbsp;&nbsp; to the execution date.
					<br>- incurred <b>100%</b> credit penalty difference if the indent is <b>15</b> days <br> &nbsp;&nbsp; to the execution date.
					<br>- <b>not</b> allow change in activity type.
					<br>- <b>not</b> allow change or increase in resources.
					<br>- <b>not</b> allow extension of date and time.</p> 
					<p>Upon recalling, the original requested resources will be reserved for 3 days, after which, if no action is taken, the indent will be <b>expired</b> and all resources released back to the pool.</p>
					<p></p>
					<P>Proceed to recall Indent?</p>
				</div>
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-default" data-dismiss="modal">Cancel</button>
				<button type="button" class="btn btn-primary" data-dismiss="modal" ng-click="submit('INDT_RCL')">Recall Indent</button>
			</div>
		</div>
	</div>
</div>

<div class="modal fade" id="revertIndentModal" tabindex="-1">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<button class="close" data-dismiss="modal">&times;</button>
				<h4 class="modal-title">Confirm?</h4>
			</div>
			<div class="modal-body">
				<div class="form-group">
					<label class="col-sm-2 control-label">Reasons for Reverting</label>
					<div class="col-sm-9">
						<textarea class="form-control" rows="3" ng-model="dto.reasons"></textarea>
					</div>
				</div>
				<label class="col-sm-2 control-label"></label>	
				<div class="col-sm-9">
					<p></p>
					<p>Please inform requester of the following:</p>
					<p>- 3 days to be re submitted and recommended if not it will be  &nbsp;&nbsp;<b>cancelled</b>.
					<br>- incurred <b>50%</b> credit penalty difference if the indent is <b>45</b> days <br> &nbsp;&nbsp; to the execution date.
					<br>- incurred <b>100%</b> credit penalty difference if the indent is <b>15</b> days <br> &nbsp;&nbsp; to the execution date.
					<br>- <b>not</b> allow change in activity type.
					<br>- <b>not</b> allow change or increase in resources.
					<br>- <b>not</b> allow extension of date and time.</p> 
					<p>Upon reverting, resources will be reserved for 3 days, after which, if no action is taken, the indent will be <b>cancelled</b> and all resources released back to the pool.</p>
					<p>Proceed to revert Indent?</p>
				</div>
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-default" data-dismiss="modal">Cancel</button>
				<button type="button" class="btn btn-primary" data-dismiss="modal" ng-click="submit('INDT_RVT')">Revert Indent</button>
			</div>
		</div>
	</div>
</div>

<div class="modal fade" id="cancelIndentModal" tabindex="-1">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<button class="close" data-dismiss="modal">&times;</button>
				<h4 class="modal-title">Confirm?</h4>
			</div>
			<div class="modal-body">
				<div class="form-group">
					<label class="col-sm-2 control-label">Reasons for Cancellation</label>
					<div class="col-sm-9">
						<textarea class="form-control" rows="3" ng-model="dto.reasons"></textarea>
					</div>
				</div>
				<label class="col-sm-2 control-label"></label>	
				<div class="col-sm-9">	
					<p></p>
					<p>Please note:</p>
					<p>- <b>50%</b> credit penalty will be incurred if indent is cancelled 45 days<br> &nbsp;&nbsp; from the execution date.
					<br>- <b>100%</b> credit penalty will be incurred if indent is cancelled 15 days <br> &nbsp;&nbsp;&nbsp;from the execution date.</p> 
					<p>Upon Cancellation, all resources released back to the pool.</p><p>Proceed to Cancel Indent?</p>
				</div>	
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-default" data-dismiss="modal">Cancel</button>
				<button type="button" class="btn btn-primary" data-dismiss="modal" ng-click="submit('INDT_CNL')">Cancel Indent</button>
			</div>
		</div>
	</div>
</div>

<div class="modal fade" id="deleteDraftModal" tabindex="-1">
	<div class="modal-dialog" style="width:400px">
		<div class="modal-content">
			<div class="modal-header">
				<button class="close" data-dismiss="modal">&times;</button>
				<h4 class="modal-title">Confirm?</h4>
			</div>
			<div class="modal-body">
				<p>Deleted Draft cannot be retrieved.<br>Proceed to delete draft?</p>
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-default" data-dismiss="modal">Cancel</button>
				<button type="button" class="btn btn-primary" data-dismiss="modal" ng-click="submit('DEL_DFT')">Delete Draft</button>
			</div>
		</div>
	</div>
</div>

<div class="modal fade" id="forwardAssistModal" tabindex="-1">
	<div class="modal-dialog" style="width:800px">
		<div class="modal-content">
			<div class="modal-header">
				<button class="close" data-dismiss="modal">&times;</button>
				<h4 class="modal-title">Forward Indent (Multi)</h4>
			</div>
			<div class="modal-body">
				<form class="form-horizontal">
					<div class="form-group">
						<label class="col-sm-2 control-label">Forward to</label>
						<div class="col-sm-9">
							<select tagbox multiple class="form-control" ng-model="dto.hubList" ng-options="hubCode.code as hubCode.name for hubCode in hubCodes | filter: filterCurrentHub(dto.hubCode)">
									<option></option>
                            </select>
						</div>
					</div>
					<div class="form-group">
						<label class="col-sm-2 control-label">Forward Reason(s)</label>
						<div class="col-sm-9">
							<textarea class="form-control" ng-model="dto.reasons" rows="3" placeholder="Please specify each reason to each hub accordingly"></textarea>
						</div>
					</div>
				</form>
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
				<button type="button" class="btn btn-primary" data-dismiss="modal" ng-click="submit('INDT_FOR_MUL')">Forward Indent</button>
			</div>
		</div>
	</div>
</div>

<div class="modal fade" id="forwardWholeModal" tabindex="-1">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<button class="close" data-dismiss="modal">&times;</button>
				<h4 class="modal-title">Forward Indent (Whole)</h4>
			</div>
			<div class="modal-body">
				<form class="form-horizontal">
					<div class="form-group">
						<label class="col-sm-2 control-label">Forward to</label>
						<div class="col-sm-4">
							<select class="form-control" ng-model="dto.forwardedHubCode">
								<option></option>
								<option data-ng-repeat="hubCode in hubCodes | filter: filterCurrentHub(dto.hubCode)" ng-value="hubCode.code">{{hubCode.name}}</option>
							</select>
						</div>
					</div>
					<div class="form-group">
						<label class="col-sm-2 control-label">Forward Reason(s)</label>
						<div class="col-sm-9">
							<textarea class="form-control" ng-model="dto.reasons" rows="3" placeholder=""></textarea>
						</div>
					</div>
				</form>
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
				<button type="button" class="btn btn-primary" data-dismiss="modal" ng-click="submit('INDT_FOR_SIN')">Forward Indent</button>
			</div>
		</div>
	</div>
</div>

<div class="modal fade" id="rejectAppIndentModal" tabindex="-1">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<button class="close" data-dismiss="modal">&times;</button>
				<h4 class="modal-title">Reject Indent</h4>
			</div>
			<div class="modal-body">
				<form class="form-horizontal">
					<!-- <div class="form-group">
						<label class="col-sm-3 control-label">Reason</label>
						<div class="col-sm-9">
							<select class="form-control">
								<option></option>
								<option>Invalid activity specified</option>
								<option>Insufficient resource quantity specified</option>
								<option>Excess resource quantity specified</option>
								<option>Invalid period specified</option>
							</select>
						</div>
					</div> -->
					<div class="form-group">
						<label class="col-sm-2 control-label">Reasons for rejection</label>
						<div class="col-sm-9">
							<textarea class="form-control" rows="3" ng-model="dto.reasons"></textarea>
						</div>
					</div>
				</form>
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
				<button type="button" class="btn btn-primary" data-dismiss="modal" ng-click="submit('INDT_REJ_APP')">Reject Indent</button>
			</div>
		</div>
	</div>
</div>

<div class="modal fade" id="rejectAccSingleIndentModal" tabindex="-1">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<button class="close" data-dismiss="modal">&times;</button>
				<h4 class="modal-title">Reject Indent</h4>
			</div>
			<div class="modal-body">
				<form class="form-horizontal">
					<div class="form-group">
						<label class="col-sm-2 control-label">Reasons for rejection</label>
						<div class="col-sm-9">
							<textarea class="form-control" rows="3" ng-model="dto.reasons"></textarea>
						</div>
					</div>
				</form>
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
				<button type="button" class="btn btn-primary" data-dismiss="modal" ng-click="submit('INDT_REJ_ACC_SIN')">Reject Indent</button>
			</div>
		</div>
	</div>
</div>

<div class="modal fade" id="rejectAccMultiIndentModal" tabindex="-1">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<button class="close" data-dismiss="modal">&times;</button>
				<h4 class="modal-title">Reject Indent</h4>
			</div>
			<div class="modal-body">
				<form class="form-horizontal">
					<div class="form-group">
						<label class="col-sm-2 control-label">Reasons for rejection</label>
						<div class="col-sm-9">
							<textarea class="form-control" rows="3" ng-model="dto.reasons"></textarea>
						</div>
					</div>
				</form>
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
				<button type="button" class="btn btn-primary" data-dismiss="modal" ng-click="submit('INDT_REJ_ACC_MUL')">Reject Indent</button>
			</div>
		</div>
	</div>
</div>

<div class="modal fade" id="rejectRecIndentModal" tabindex="-1">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<button class="close" data-dismiss="modal">&times;</button>
				<h4 class="modal-title">Reject Indent</h4>
			</div>
			<div class="modal-body">
				<form class="form-horizontal">
					<div class="form-group">
						<label class="col-sm-2 control-label">Reasons for rejection</label>
						<div class="col-sm-9">
							<textarea class="form-control" rows="3" ng-model="dto.reasons"></textarea>
						</div>
					</div>
				</form>
				<label class="col-sm-2 control-label"></label>	
				<div class="col-sm-9">	
					<p></p>
					<p>Please note:</p>
					<p>- Rejecting indent will have its booked resources released.</p>
					<p><b>- Rejecting a non-waiting list indent that is previously recalled or reverted will be treated as CANCEL indent and credit penalty will apply.</b></p>
				</div>	
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
				<button type="button" class="btn btn-primary" data-dismiss="modal" ng-click="submit('INDT_REJ_REC')">Reject Indent</button>
			</div>
		</div>
	</div>
</div>

<div class="modal fade" id="rejectCfmIndentModal" tabindex="-1">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<button class="close" data-dismiss="modal">&times;</button>
				<h4 class="modal-title">Reject Indent</h4>
			</div>
			<div class="modal-body">
				<form class="form-horizontal">
					<div class="form-group">
						<label class="col-sm-2 control-label">Reasons for rejection</label>
						<div class="col-sm-9">
							<textarea class="form-control" rows="3" ng-model="dto.reasons"></textarea>
						</div>
					</div>
				</form>
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
				<button type="button" class="btn btn-primary" data-dismiss="modal" ng-click="submit('INDT_REJ_CFM')">Reject Indent</button>
			</div>
		</div>
	</div>
</div>

<div class="modal fade" id="rejectCvModal" tabindex="-1">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<button class="close" data-dismiss="modal">&times;</button>
				<h4 class="modal-title">Reject Indent</h4>
			</div>
			<div class="modal-body">
				<form class="form-horizontal">
					<div class="form-group">
						<label class="col-sm-2 control-label">Reasons for rejection</label>
						<div class="col-sm-9">
							<textarea class="form-control" rows="3" ng-model="dto.reasons"></textarea>
						</div>
					</div>
				</form>
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
				<button type="button" class="btn btn-primary" data-dismiss="modal" ng-click="submit('REJ')">Reject Indent</button>
			</div>
		</div>
	</div>
</div>

<div class="modal fade" id="confirmIndentModal" tabindex="-1">
	<div class="modal-dialog" style="width:400px">
		<div class="modal-content">
			<div class="modal-header">
				<button class="close" data-dismiss="modal">&times;</button>
				<h4 class="modal-title">Confirm?</h4>
			</div>
			<div class="modal-body">
				<div class="container-fluid">
					<p>Proceed to confirm Indent?</p>
				</div>
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-default" data-dismiss="modal">Cancel</button>
				<button type="button" class="btn btn-primary" data-dismiss="modal" ng-click="submit('INDT_CFM')">Confirm Indent</button>
			</div>
		</div>
	</div>
</div>

<div class="modal fade" id="cancelResourceModal" tabindex="-1">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<button class="close" data-dismiss="modal">&times;</button>
				<h4 class="modal-title">Refund Resources</h4>
			</div>
			<div class="modal-body">
				<form class="form-horizontal">
					<div class="form-group">
						<label class="col-sm-4 control-label">Selected Tasks</label>
						<div class="col-sm-8 control-value">
						<div ng-repeat='taskId in taskRefundCreditDTO.taskIds'>
						{{taskId}}<br>
						</div>
						</div>
					</div>
					<div class="form-group">
						<label class="col-sm-4 control-label">Reason</label>
						<div class="col-sm-8">
							<select class="form-control" ng-model="taskRefundCreditDTO.reason" ng-options="reason.id as reason.name for reason in reasons">
							</select>
						</div>
					</div>
					<div class="form-group">
						<label class="col-sm-4 control-label">Credits to be Refunded</label>
						<div class="col-sm-8 control-value">{{taskRefundCreditDTO.totalCredit}}</div>
					</div>
				</form>
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
				<button type="button" class="btn btn-primary" data-dismiss="modal" ng-click="confirmRefundResource(taskRefundCreditDTO)">Refund Resources</button>
			</div>
		</div>
	</div>
</div>

<div class="modal fade" id="indentTemplateModal" tabindex="-1">
	<div class="modal-dialog" style="width: 500px">
		<div class="modal-content">
			<div class="modal-header">
				<button class="close" data-dismiss="modal">
					&times;
				</button>
				<h4 class="modal-title">Save as Template</h4>
			</div>
			<div class="modal-body">
				<div class="container-fluid">
					<form class="form-horizontal">
						<div class="form-group">
							<label class="col-sm-3 control-label">Template Name</label>
							<div class="col-sm-9">
								<input type="text" class="form-control" placeholder="" value="Custom Template 5">
							</div>
						</div>
						<div class="form-group">
							<label class="col-sm-3 control-label">Template Type</label>
							<div class="col-sm-9">
								<select ng-model="templateType" class="form-control">
									<option>Generic</option>
									<option>Role-Based</option>
								</select>
							</div>
						</div>
						<div ng-show="templateType=='Role-Based'" class="form-group">
							<label class="col-sm-3 control-label">Role</label>
							<div class="col-sm-9 control-value">Hub Controller (HUB EAST)</div>
						</div>
					</form>
				</div>
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-default" data-dismiss="modal">Cancel</button>
				<button type="button" class="btn btn-primary" data-dismiss="modal" ng-click="go('/operator')">Submit</button>
			</div>
		</div>
	</div>
</div>

<div class="modal fade" id="allocateDriverModal" tabindex="-1">
	<div class="modal-dialog" style="width:1000px">
		<div class="modal-content">
			<div class="modal-header">
				<button class="close" data-dismiss="modal">&times;</button>
				<h4 class="modal-title">Assign / Re-Assign Driver</h4>
			</div>
			<div class="modal-body">
				<div class="container-fluid">
					<form class="form-horizontal">
						<div class="form-group">
							<label class="col-sm-3 control-label">Detail Period</label>
							<div class="col-sm-9 control-value">
								{{searchDTO.detailPeriodRange}}
							</div>
						</div>
						<div class="form-group" >
							<label class="col-sm-3 control-label">Driver Origin</label>
							<div class="col-sm-9">
								<div class="radio radio-inline" >
									<label >
										<input type="radio" name="driverOrigin" ng-model="searchDTO.driverOrigin" value="1">Transport Operator
									</label>
								</div>
								<div class="radio radio-inline">
									<label>
										<input type="radio" name="driverOrigin" ng-model="searchDTO.driverOrigin" value="2" >Dual Vocation (DV) Driver
									</label>
								</div>
								<div class="radio radio-inline">
									<label>
										<input type="radio" name="driverOrigin" ng-model="searchDTO.driverOrigin" value="3" >LOA Driver
									</label>
								</div>
								<div class="radio radio-inline">
									<label>
										<input type="radio" name="driverOrigin" ng-model="searchDTO.driverOrigin" value="4" >NS Transport Operator
									</label>
								</div>
								<div class="radio radio-inline">
									<label>
										<input type="radio" name="driverOrigin" ng-model="searchDTO.driverOrigin" value="5" >Transport Leader
									</label>
								</div>
							</div>
						</div>

						<div class="form-group">
							<label class="col-sm-3 control-label">Additional Options</label>
							<div class="col-sm-9">
								<div class="checkbox checkbox-inline">
									<label>
										<input type="checkbox" name="include" ng-model="searchDTO.isBufferedTO" >Buffered TOs
									</label>
								</div>
<!-- 								<div class="checkbox checkbox-inline"> -->
<!-- 									<label> -->
<!-- 										<input type="checkbox" name="include" ng-model="searchDTO.isTL" >TLs -->
<!-- 									</label> -->
<!-- 								</div> -->
								<div class="checkbox checkbox-inline">
									<label>
										<input type="checkbox" name="include" ng-model="searchDTO.isDriverTrainee" >Driver Trainees
									</label>
								</div>
								<div class="checkbox checkbox-inline">
									<label>
										<input type="checkbox" name="include" ng-model="searchDTO.isNoRestDriver" >2 Hours No-Rest Drivers
									</label>
								</div>
							</div>
						</div>


						<div class="form-group">
							<label class="col-sm-3 control-label">Tow Types</label>
							<div class="col-sm-9">
								<select tagbox class="form-control" multiple ng-model="searchDTO.towTypeIds"  ng-options="towType.id as towType.name for towType in towTypes"></select>								
							</div>
						</div>

						<div class="form-group">
							<label class="col-sm-3 control-label">Soldier Proficiencies</label>
							<div class="col-sm-9">
								
								<select tagbox class="form-control" multiple  ng-model="searchDTO.proficiencyIds" ng-options="proficiency.id as proficiency.name for proficiency in proficiencies1">
	                               <option />
	                            </select> 
							</div>
						</div>

						<div class="col-sm-3">
						</div>
						<div class="col-sm-9">
							<a class="clickable" ng-click="moreCriteriaCollapsed = !moreCriteriaCollapsed">More Criteria...</a>
						</div>
						
						<div uib-collapse="moreCriteriaCollapsed">


							<div class="form-group">
							<label class="col-sm-3 control-label">Hub</label>
								<div class="col-sm-3" ng-if="session.userRole.cat !== 'Hub' && session.userRole.cat !== 'Node'">
								<select class="form-control" ng-model="searchDTO.hubCode" ng-options="hub.code as hub.name for hub in hubs">
									<option />
								</select>
							</div>
							<div class="col-sm-3" ng-if="session.userRole.cat === 'Hub' || session.userRole.cat === 'Node'">
								<input class="form-control" ng-model="session.userRole.hub" readonly/>
							</div>
							<label class="col-sm-2 control-label">Node</label>
								<div class="col-sm-4" ng-if="session.userRole.cat !== 'Node'">
									<select class="form-control" ng-model="searchDTO.nodeId" ng-options="node.id as node.name for node in nodes | filter:filterNodes(searchDTO.hubCode)">
								<option></option>
								</select>
								</div>
								<div class="col-sm-4" ng-if="session.userRole.cat === 'Node'">
									<input class="form-control" ng-model="session.userRole.node" readonly/>
								</div>
						</div>

							<div class="form-group">
							
								<label class="col-sm-3 control-label">Unit</label>
								<div class="col-sm-3">
									<select id="" class="form-control" ng-model="searchDTO.unitCode" ng-options="unit.code as unit.name for unit in units">
										<option></option>
									</select>
								</div>
								<div class="col-sm-2 control-label"></div>
								<div  class="col-sm-4"></div>
							</div>

							<div class="form-group">
								<label class="col-sm-3 control-label">Rank</label>
								<div class="col-sm-2">
									<select id="" class="form-control" ng-model="searchDTO.rankCode" ng-options="rank.code as rank.name for rank in ranks">
										<option></option>
									</select>
								</div>

								<label class="col-sm-3 control-label">PES</label>
								<div class="col-sm-2">
									<select id="" class="form-control" ng-model="searchDTO.pesCode" ng-options="pes.code as pes.name for pes in peses">
										<option></option>
									</select>
								</div>
							</div>

							<div class="form-group">
								<label class="col-sm-3 control-label">Driver NRIC No.</label>
								<div class="col-sm-2">
									<input id="" class="form-control" ng-model="searchDTO.driverNricNo" placeholder="">
								</div>

								<label class="col-sm-3 control-label">Driver Name</label>
								<div class="col-sm-4">
									<input id="" class="form-control" ng-model="searchDTO.driverName" placeholder="">
								</div>
							</div>

							<div class="form-group">
								<label class="col-sm-3 control-label">Security CAT</label>
								<div class="col-sm-3">
									<select id="" class="form-control" ng-model="searchDTO.securityCatCode" ng-options="securityCategory.code as securityCategory.name for securityCategory in securityCategories">
										<option></option>
									</select>
								</div>

								<label class="col-sm-2 control-label">Driver CAT</label>
								<div class="col-sm-2">
									<select id="" class="form-control" ng-model="searchDTO.driverCatId" ng-options="licenseCategory.id as licenseCategory.name for licenseCategory in licenseCategories">
										<option></option>
									</select>
								</div>
							</div>
						</div>
						
						<button type="button" class="btn btn-primary btn-sm pull-right" ng-click="showDriverResults(true)" ng-disabled="loading" style="margin-left:5px">Search</button>
						<button type="button" class="btn btn-primary btn-sm pull-right" ng-click="bestMatchVehicleDriver('driver')" ng-disabled="loading">Best Match</button>
						<br><br><br>
					</form>
					
					<table st-table="driver" st-safe-src="driverResults" class="table table-striped table-bordered table-responsive table-condensed small">
						<tr>
							<th class="text-center">#</th>
							<th>Driver</th>
							<th>NRIC No.</th>
							<th>Node</th>
							<th>Available From</th>
							<th>Available To</th>
							<th>Previous Task Start</th>
							<th>Previous Task End</th>
							<th>Last Drive Vehicle Type</th>
							<th></th>
						</tr>
						<tr ng-repeat="record in driverResults">
							<td class="text-right">{{$index+1}}.</td>
							<td>{{record.driverName}}</td>
							<td>{{record.driverNric}}</td>
							<td>{{record.driverNode}}</td>
							<td style="white-space:nowrap">{{record.availableFrom}}</td>
							<td style="white-space:nowrap">{{record.availableTo}}</td>
							<td>{{record.previousTaskStart}}</td>
							<td>{{record.previousTaskEnd}}</td>
							<td>{{record.vehicleType}}</td>
							<td><button type="button" class="btn btn-default btn-xs" data-toggle="modal" ng-click="assignDriverConfirmDialog(record)">Assign</button></td>
						</tr>
					</table>
				</div>
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
			</div>
		</div>
	</div>
</div>

<div class="modal fade" id="allocateVehicleModal" tabindex="-1">
	<div class="modal-dialog" style="width:900px">
		<div class="modal-content">
			<div class="modal-header">
				<button class="close" data-dismiss="modal">&times;</button>
				<h4 class="modal-title">Assign / Re-Assign Vehicle</h4>
			</div>
			<div class="modal-body">
				<div class="container-fluid">
					<form class="form-horizontal">
						<div class="form-group">
							<label class="col-sm-3 control-label">Detail Period</label>
							<div class="col-sm-9 control-value">
								{{searchDTO.detailPeriodRange}}
							</div>
						</div>
						<div class="form-group">
							<label class="col-sm-3 control-label">Additional Options</label>
							<div class="col-sm-9">
								<div class="checkbox checkbox-inline">
									<label>
										<input type="checkbox" name="include" ng-model="searchDTO.isBuffered" >Buffered Vehicles
									</label>
								</div>
							</div>
						</div>
						<div class="form-group">
							<label class="col-sm-3 control-label">Vehicle Type</label>
							<div class="col-sm-5">
								<select class="form-control" ng-model="searchDTO.vehicleTypeId" ng-options="vehicleType.id as vehicleType.name for vehicleType in vehicleTypes">
									<option></option>
								</select>
							</div>
						</div>
						<div class="form-group">
							<label class="col-sm-3 control-label">Hub</label>
								<div class="col-sm-4" ng-if="session.userRole.cat !== 'Hub' && session.userRole.cat !== 'Node'">
								<select class="form-control" ng-model="searchDTO.hubCode" ng-options="hub.code as hub.name for hub in hubs">
									<option />
								</select>
							</div>
							<div class="col-sm-4" ng-if="session.userRole.cat === 'Hub' || session.userRole.cat === 'Node'">
								<input class="form-control" ng-model="session.userRole.hub" readonly/>
							</div>
						</div>
						<div class="form-group">
							<label class="col-sm-3 control-label">Node</label>
								<div class="col-sm-3" ng-if="session.userRole.cat !== 'Node'">
									<select class="form-control" ng-model="searchDTO.nodeId" ng-options="node.id as node.name for node in nodes | filter:filterNodes(searchDTO.hubCode)">
								<option></option>
								</select>
								</div>
								<div class="col-sm-3" ng-if="session.userRole.cat === 'Node'">
									<input class="form-control" ng-model="session.userRole.node" readonly/>
								</div>
						</div>
						<div class="form-group">
							<label class="col-sm-3 control-label">Vehicle No.</label>
							<div class="col-sm-2">
								<input type="text" class="form-control" ng-model="searchDTO.vehicleNo" placeholder="">
							</div>
						</div>
						<button type="button" class="btn btn-primary btn-sm pull-right" style="margin-left:5px" ng-click="showVehicleResults(true)" ng-disable="!loading">Search</button>						
						<button type="button" class="btn btn-primary btn-sm pull-right" ng-click="bestMatchVehicleDriver('vehicle')" ng-disable="!loading">Best Match</button>
						<br>
					</form>
					<table st-table="vehicle" st-safe-src="vehicleResults" class="table table-striped table-bordered table-responsive table-condensed small">
						<tr>
							<th class="text-center">#</th>
							<th>Vehicle No.</th>
							<th>Description</th>
							<th>Vehicle Node</th>
							<th>Available From</th>
							<th>Available To</th>
							<th>Previous Task Start</th>
							<th>Previous Task End</th>
							<th>Last Driver</th>
							<th></th>
						</tr>
						<tr ng-repeat="record in vehicleResults">
							<td class="text-right">{{record.id}}.</td>
							<td>{{record.vehicleNo}}</td>
							<td>{{record.vehicleType}}</td>
							<td>{{record.vehicleNode}}</td>
							<td style="white-space:nowrap">{{record.availableFrom}}</td>
							<td style="white-space:nowrap">{{record.availableTo}}</td>
							<td>{{record.previousTaskStart}}</td>
							<td>{{record.previousTaskEnd}}</td>
							<td>{{record.lastTODrive}}</td>
							<td><button type="button" class="btn btn-default btn-xs" ng-click="assignVehicleConfirmDialog(record)">Assign</button></td>
						</tr>
					</table>
					
				</div>
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
			</div>
		</div>
	</div>
</div>

<div id="resourceConfirmDialog" class="modal fade" tabindex="-1">
		<div class="modal-dialog" style="width:500px">
			<div class="modal-content">
				<div class="modal-header">
					<button class="close" data-dismiss="modal">&times;</button>
					<h4 class="modal-title"><span class="glyphicon glyphicon-question-sign"></span> Confirm</h4>
				</div>
				<div class="modal-body">
				<div class="container-fluid">
					<form class="form-horizontal">
						<div class="form-group">
							Are you sure you want to assign the following {{searchDTO.type}} to Task ({{searchDTO.taskId}}): <br>
							<div ng-if="searchDTO.type == 'vehicle'">Vehicle: {{selectedResource.vehicleNo}} ({{selectedResource.vehicleType}})</div>
							<div ng-if="searchDTO.type == 'driver'">Driver: {{selectedResource.driverName}} ({{selectedResource.driverNric}})</div>
						</div>
					</form>
				</div>
			</div>
				<div class="modal-footer">
					<button type="button" class="btn btn-default" data-dismiss="modal">Cancel</button>
					<button type="button" class="btn btn-primary" data-dismiss="modal" ng-click="confirmChangeVehicleDriver()">Confirm </button>
				</div>
			</div>
		</div>
</div>